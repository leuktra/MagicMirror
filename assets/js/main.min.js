!function(a){function b(){this.configMirror(),this.init()}b.prototype={updateWithText:function(a,b){var c="fade-out";this.innerHTML!==a&&(classie.add(this,c),setTimeout(function(){classie.remove(this,c)},b))},configMirror:function(){var b=this;this.config={},this.config.lang=a.navigator.language,this.config.weatherParams={q:"Katowice,Polska",units:"metric",lang:b.lang},this.config.feeds=[],this.config.messages={},this.config.messages.morning=["Dzień dobry, przystojniaku!","Miłego dnia!","Niewyspany? Napij się kawy...","Jak się spało?","Dzień dobry, kocham Cię!"],this.config.messages.afternoon=["Nieźle wyglądasz!","Czemu nie ma cię w pracy?","Do roboty leniu!","Cześć, piękny!"],this.config.messages.evening=["Jak w pracy?","Założyłbyś dres!","Może szklaneczka whisky?","Czas odpocząć, nie sądzisz?"],this.config.messages.night=["Czemu jeszcze nie śpisz?","Dobranoc!","Rano będzie źle..."],this.config.timeouts={},this.config.timeouts.calendarParse=2e3,this.config.timeouts.calendarUpdate=2e3,this.config.timeouts.revision=2e3,console.log(this.config)},init:function(){this.updateRevisionHandler(),this.momentLocalization(),this.calendarParseHandler()},updateRevisionHandler:function(){console.log("update revision handler fn");var a=this,b="GET",c="git_version.php";this.checkRevision=function(){console.log("check revision fn");var a=new XMLHttpRequest;a.onreadystatechange=function(){4===a.readyState&&200===a.status&&console.log(a.responseText)},a.open(b,c,!0),a.send()},setTimeout(function(){a.checkRevision()},a.config.timeouts.revision)},momentLocalization:function(){},calendarParseHandler:function(){var a=this;this.calendar={},this.calendar.eventList=[],a.parseCalendar=function(b){a.calendar.events=b.getEvents();for(var c in a.calendar.events){var d=a.calendar.events[c];for(var e in d){var f=d[e],g=e.search(";");if(g>=0){var h,i=e.substring(0,g),j=e.substring(g+1);("DTSTART"===i||"DTEND"===i)&&(h="VALUE=DATE"===j?new Date(f.substring(0,4),f.substring(4,6),f.substring(6,8)):new Date(f.substring(0,4),f.substring(4,6),f.substring(6,8),f.substring(9,11),f.substring(11,13),f.substring(13,15)),"DTSTART"===i&&(d.dateStart=h),"DTEND"===i&&(d.dateEnd=h))}}var k={};if("undefined"==typeof d.dateStart?(k.days=moment(d.DTSTART).diff(moment(),"days"),k.seconds=moment(d.DTSTART).diff(moment(),"seconds"),k.startDate=moment(d.DTSTART)):(k.days=moment(d.dateStart).diff(moment(),"days"),k.seconds=moment(d.dateStart).diff(moment(),"seconds"),k.startDate=moment(d.dateStart)),k.seconds>=0&&(console.log(k.seconds),d.timeString=k.seconds<=18e3||k.seconds>=172800?moment(k.startDate).fromNow():moment(k.startDate).calendar(),!d.RRULE)){var l={description:d.SUMMARY,seconds:k.seconds,days:d.timeString};a.calendar.eventList.push(l)}if(d.RRULE){var m=new RRule.parseString(d.RRULE);m.dtstart=d.dateStart;var n=new RRule(m);console.log(n);var o=n.between(new Date,new Date(2016,11,31),!0,function(){return 10>c});console.log(o);for(var p in o){var q={};if(q.date=new Date(o[p]),q.days=moment(q.date).diff(moment(),"days"),q.seconds=moment(q.date).diff(moment(),"seconds"),q.dateStart=moment(q.date),q.seconds>=0){d.timeString=q.seconds<=18e3||q.seconds>=172800?moment(q.date).fromNow():moment(q.date).calendar();var r={description:d.SUMMARY,seconds:q.seconds,days:d.timeString};a.calendar.eventList.push(r)}}}}a.calendar.eventList.sort(function(a,b){return a.seconds-b.seconds}),console.log(a.calendar.eventList)},new ical_parser("calendar.php",a.parseCalendar),this.calendarUpdateHandler(),setTimeout(function(){},a.config.timeouts.calendarParse)},calendarUpdateHandler:function(){var a=this;this.calendar.table=document.getElementById("calendar-table");for(var b in a.calendar.eventList)console.log(a.calendar.eventList);setTimeout(function(){},a.config.timeouts.calendarUpdate)},complimentsUpdateHandler:function(){}},a.MagicMirror=new b}(window);